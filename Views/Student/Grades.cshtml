
@using Learning_Management_System.Models
@{
    ViewData["Title"] = "My Grades";
    Layout = "_Layout";
    var grades = ViewBag.Grades as IEnumerable<VwAllStudentGrade> ?? Enumerable.Empty<VwAllStudentGrade>();
}

@section Styles {
    <link rel="stylesheet" href="~/css/pages/grades.css">
}

@await Html.PartialAsync("_StudentNav")

<main class="container-xl my-4 my-md-5">
    <div class="mb-5">
        <h1 class="page-title display-4 fw-bold">My Grades</h1>
        <p class="subtitle text-secondary fs-5">An overview of your academic performance across all courses.</p>
    </div>

    <div class="grades-card card bg-body-tertiary border-secondary-subtle shadow-sm rounded-4 overflow-hidden">
        <div class="card-header bg-transparent px-4 pt-3">
            <h2 class="section-title fs-4 fw-semibold">Course Grades</h2>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-borderless mb-0">
                    <thead class="table-light">
                        <tr class="text-secondary text-uppercase small">
                            <th class="px-4 py-3">Course</th>
                            <th class="px-4 py-3 text-center">Type</th>
                            <th class="px-4 py-3 text-center">Score</th>
                            <th class="px-4 py-3 text-end">Percentage</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (!grades.Any())
                        {
                            <tr>
                                <td class="px-4 fw-medium text-secondary" colspan="5">No grades recorded yet.</td>
                            </tr>
                        }
                        else
                        {
                            foreach (var grade in grades)
                            {
                                var percentage = grade.MaxPoints > 0 ? (grade.Points / grade.MaxPoints) * 100 : 0;
                                <tr>
                                    <td class="px-4">@grade.CourseTitle</td>
                                    <td class="px-4 text-center text-secondary">@grade.GradableItemType</td>
                                    <td class="px-4 text-center">@grade.Points / @grade.MaxPoints</td>
                                    <td class="px-4 text-end fw-semibold">@Math.Round(percentage, 1)%</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</main>