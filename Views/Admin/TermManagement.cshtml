@{
    ViewData["Title"] = "Manage Academic Terms";
    Layout = "_AdminLayout";
    ViewData["AdminActive"] = "terms";
}

@section Styles {
    <link rel="stylesheet" href="~/css/pages/term-manegment_admin.css">
}

  <main class="flex-grow-1">
    
    
    <div class="p-4" style="padding: 2.5rem !important;">
      @if (TempData["Error"] != null)
      {
          <div class="alert alert-danger alert-dismissible fade show mb-4" role="alert">
              <div class="d-flex align-items-center">
                  <span class="material-symbols-outlined me-2">error</span>
                  <div>@TempData["Error"]</div>
              </div>
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
      }

      <div class="d-flex flex-wrap align-items-center justify-content-between gap-4 mb-5">
        <div class="d-flex flex-column gap-1">
          <h1 class="h3 fw-bold mb-0">Manage Academic Terms</h1>
          <p class="fs-sm text-secondary mb-0">Create, view, and manage all academic terms for the institution.</p>
        </div>
        <a class="btn btn-primary d-inline-flex align-items-center justify-content-center gap-2 rounded-3 fs-sm fw-bold py-2 px-4" style="min-width: 84px;" asp-controller="Admin" asp-action="CreateAcademicTerm" role="button">
          <span class="material-symbols-outlined fs-6">add</span>
          <span>Add New Term</span>
        </a>
      </div>
      
      <div class="card border rounded-4 overflow-hidden shadow-none mb-4">
        <div class="card-body p-3">
            <form asp-action="AcademicTerms" method="get" class="row g-3">
                <div class="col-md-6">
                    <div class="input-group">
                        <span class="input-group-text bg-body-secondary border-end-0">
                            <span class="material-symbols-outlined fs-6 text-secondary">search</span>
                        </span>
                        <input type="text" name="searchString" class="form-control border-start-0 ps-0" placeholder="Search by term name..." value="@ViewBag.SearchString">
                        <button class="btn btn-outline-secondary border-start-0" type="submit">Search</button>
                    </div>
                </div>
                <div class="col-md-3">
                    <select name="status" class="form-select" onchange="this.form.submit()">
                        <option value="All" selected="@(ViewBag.CurrentStatus == "All" || ViewBag.CurrentStatus == null)">All Statuses</option>
                        <option value="Active" selected="@(ViewBag.CurrentStatus == "Active")">Active</option>
                        <option value="Upcoming" selected="@(ViewBag.CurrentStatus == "Upcoming")">Upcoming</option>
                        <option value="Archived" selected="@(ViewBag.CurrentStatus == "Archived")">Archived</option>
                    </select>
                </div>
                <div class="col-md-3 text-end">
                    <a asp-action="AcademicTerms" class="btn btn-link text-secondary">Reset</a>
                </div>
            </form>
        </div>
      </div>
      
      <div class="card border rounded-4 overflow-hidden shadow-none">
        <div class="table-responsive">
          <table class="table w-100 text-start align-middle mb-0">
            <thead class="text-uppercase">
              <tr>
                <th class="px-4 py-3" scope="col">Term Name</th>
                <th class="px-4 py-3" scope="col">Start Date</th>
                <th class="px-4 py-3" scope="col">End Date</th>
                <th class="px-4 py-3" scope="col">Status</th>
                <th class="px-4 py-3 text-end" scope="col">Actions</th>
              </tr>
            </thead>
            <tbody>
              @if (ViewBag.Terms != null)
              {
                  foreach (var term in ViewBag.Terms)
                  {
                      <tr>
                        <td class="px-4 py-3 text-nowrap fs-sm fw-medium">@term.TermName</td>
                        <td class="px-4 py-3 text-nowrap fs-sm text-secondary">@term.StartDate.ToShortDateString()</td>
                        <td class="px-4 py-3 text-nowrap fs-sm text-secondary">@term.EndDate.ToShortDateString()</td>
                        <td class="px-4 py-3 text-nowrap fs-sm">
                          @if (term.IsActive)
                          {
                              <span class="badge d-inline-flex align-items-center rounded-pill bg-success-subtle text-success fs-xs fw-semibold px-3 py-1">
                                <span class="rounded-circle me-2" style="width: 6px; height: 6px; background-color: currentColor;"></span>Active
                              </span>
                          }
                          else if (term.EndDate < DateOnly.FromDateTime(DateTime.Now))
                          {
                              <span class="badge d-inline-flex align-items-center rounded-pill bg-secondary-subtle text-secondary fs-xs fw-semibold px-3 py-1">
                                <span class="rounded-circle me-2" style="width: 6px; height: 6px; background-color: currentColor;"></span>Archived
                              </span>
                          }
                          else
                          {
                              <span class="badge d-inline-flex align-items-center rounded-pill bg-warning-subtle text-warning fs-xs fw-semibold px-3 py-1">
                                <span class="rounded-circle me-2" style="width: 6px; height: 6px; background-color: currentColor;"></span>Upcoming
                              </span>
                          }
                        </td>
                        <td class="px-4 py-3 text-nowrap text-end fs-sm fw-medium">
                          <div class="d-flex justify-content-end gap-1">
                            <a class="btn btn-icon" asp-action="EditAcademicTerm" asp-route-id="@term.AcademicTermId">
                              <span class="material-symbols-outlined fs-5">edit</span>
                            </a>
                            <form asp-action="DeleteAcademicTerm" method="post" onsubmit="return confirm('Are you sure you want to delete this term?');" style="display:inline;">
                                <input type="hidden" name="id" value="@term.AcademicTermId" />
                                <button type="submit" class="btn btn-icon hover-danger">
                                  <span class="material-symbols-outlined fs-5">delete</span>
                                  
                                </button>
                            </form>
                          </div>
                        </td>
                      </tr>
                  }
              }
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </main>
  
  <!-- <div class="position-fixed bottom-0 end-0 m-4 z-2" style="margin-bottom: 2rem !important; margin-right: 2rem !important;">
    <button class="btn btn-primary btn-lg rounded-circle d-flex align-items-center justify-content-center shadow-lg theme-toggler" style="width: 3.5rem; height: 3.5rem;">
      <span class="material-symbols-outlined fs-4 icon-light">light_mode</span>
      <span class="material-symbols-outlined fs-4 icon-dark">dark_mode</span>
    </button>
  </div> -->
