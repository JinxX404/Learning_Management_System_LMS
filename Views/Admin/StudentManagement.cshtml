@{
    ViewData["Title"] = "Student Management";
    Layout = "_Layout";
    ViewData["AdminActive"] = "students";
}

@section Styles {
    <link rel="stylesheet" href="~/css/pages/student-manegment_admin.css">
}

<div class="d-flex min-vh-100">
  @await Html.PartialAsync("_AdminSidebar")
  
  <div class="flex-grow-1 d-flex flex-column">
    <!-- <header class="d-flex align-items-center justify-content-between border-bottom bg-body-tertiary px-4 py-3">
      <div class="d-flex align-items-center gap-4">
        <h2 class="text-body-emphasis h5 fw-bold mb-0">Student Management</h2>
      </div>
      <div class="d-flex flex-grow-1 align-items-center justify-content-end gap-4">
        <a class="btn btn-primary fw-bold fs-sm py-2 px-3" style="min-width: 84px;" asp-controller="Admin" asp-action="CreateStudent" role="button">
          <span>Add New Student</span>
        </a>
        <div class="d-flex align-items-center gap-3">
          <button class="btn btn-icon-header rounded-circle p-2">
            <span class="material-symbols-outlined fs-5">notifications</span>
          </button>
          <button class="btn btn-icon-header rounded-circle p-2">
            <span class="material-symbols-outlined fs-5">chat</span>
          </button>
          <div class="d-flex align-items-center gap-2">
            <div class="bg-center bg-no-repeat bg-cover rounded-circle" data-alt="User avatar" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCFkpYwFJxJU9bnptpIu_zw1TDI4LW_bnnw-VQ6wWa1nJO3UHgtZedu_gwhiaSjVV7FpJy5tkNGMX2fi-4b_fI6Xhq62OpBWdGI4Pt5DBh9BvH2227wQ0Rk7L19tcekVch8fe9Vxd7AGC_NtOl18UjKK0GOChazaJoiFZKEFrpCrudq9xnwgRo62RRMlVYvYvlQ9BoU2irsFF63RmegsflWNA9Ku_rJja3T-cdswDqask5XFdI_fLCrHfEBGkrGYJMbc87wMLP57WM"); width: 2.5rem; height: 2.5rem;'></div>
            <div class="d-none d-sm-flex flex-column text-start">
              <span class="fs-sm fw-medium text-body-emphasis">Admin User</span>
              <span class="fs-xs text-secondary">admin@academix.edu</span>
            </div>
          </div>
        </div>
      </div>
    </header> -->
    

    
    <main class="flex-grow-1 p-4">

    <div class="container-xxl mx-auto">
      <div class="d-flex flex-wrap justify-content-between align-items-center gap-3 mb-5 mt-4">
        <h1 class="h2 fw-bolder text-body">Student Management</h1>
        <a class="btn btn-primary d-inline-flex align-items-center justify-content-center gap-2 rounded-3 fw-bold fs-sm px-4" style="min-width: 84px; height: 2.5rem;" asp-action="CreateStudent" role="button">
          <span class="material-symbols-outlined">add</span>
          <span>Add New Student</span>
        </a>
      </div>
      <div class="card bg-body-tertiary border rounded-4 overflow-hidden">
        <div class="p-4 border-bottom">
          <div class="mb-4">
            <label class="w-100">
              <div class="input-group rounded-lg overflow-hidden">
                <span class="input-group-text input-group-text-search text-secondary">
                  <span class="material-symbols-outlined">search</span>
                </span>
                <input class="form-control form-control-search text-body-emphasis" placeholder="Search by name, email, or ID..." value="" />
              </div>
            </label>
          </div>
          <div class="d-flex flex-wrap align-items-center gap-3">
            <button class="btn btn-outline-secondary d-inline-flex align-items-center justify-content-center gap-2 rounded-lg py-2 ps-3 pe-2">
              <span class="material-symbols-outlined fs-6">filter_list</span>
              <p class="fs-sm fw-medium mb-0">Status: All</p>
              <span class="material-symbols-outlined fs-6">expand_more</span>
            </button>
            <button class="btn btn-outline-secondary d-inline-flex align-items-center justify-content-center gap-2 rounded-lg py-2 ps-3 pe-2">
              <span class="material-symbols-outlined fs-6">calendar_today</span>
              <p class="fs-sm btn-outline-secondary fw-medium mb-0">Enrollment Date: All Time</p>
              <span class="material-symbols-outlined fs-6">expand_more</span>
            </button>
            <div class="flex-grow-1"></div>
            <button class="btn btn-link text-secondary fs-sm fw-medium rounded-lg px-3 py-2">
              Reset
            </button>
            <button class="btn btn-primary fs-sm fw-medium rounded-lg px-3 py-2">
              Apply Filters
            </button>
          </div>
        </div>
        
        <div class="table-responsive">
          <table class="table w-100 fs-sm text-start align-middle mb-0 table-hover">
            <thead class="fs-xs text-uppercase">
              <tr>
                <th class="p-4" scope="col">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="" id="checkbox-all" />
                    <label class="form-check-label visually-hidden" for="checkbox-all">Select all</label>
                  </div>
                </th>
                <th class="px-4 py-3" scope="col">Student Name</th>
                <th class="px-4 py-3" scope="col">Student ID</th>
                <th class="px-4 py-3" scope="col">Email</th>
                <th class="px-4 py-3" scope="col">Enrollment Date</th>
                <th class="px-4 py-3" scope="col">Status</th>
                <th class="px-4 py-3 text-end" scope="col">Actions</th>
              </tr>
            </thead>
            <tbody>
              @if (ViewBag.Students != null)
              {
                  foreach (var student in ViewBag.Students)
                  {
                      <tr class="border-top">
                        <td class="w-4 p-4">
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="@student.UserId" id="checkbox-table-@student.UserId" />
                            <label class="form-check-label visually-hidden" for="checkbox-table-@student.UserId">Select row @student.UserId</label>
                          </div>
                        </td>
                        <th class="d-flex align-items-center px-4 py-3 text-body-emphasis text-nowrap" scope="row">
                          <div class="bg-center bg-no-repeat bg-cover rounded-circle d-flex align-items-center justify-content-center bg-primary-subtle text-primary fw-bold" style="width: 2.5rem; height: 2.5rem;">
                              @{
                                  var firstInitial = !string.IsNullOrEmpty(student.FirstName) ? student.FirstName.Substring(0,1) : "?";
                                  var lastInitial = !string.IsNullOrEmpty(student.LastName) ? student.LastName.Substring(0,1) : "?";
                              }
                              @firstInitial@lastInitial
                          </div>
                          <div class="ps-3">
                            <div class="fw-semibold">@student.FirstName @student.LastName</div>
                          </div>
                        </th>
                        <td class="px-4 py-3">STU-@student.UserId.ToString("D5")</td>
                        <td class="px-4 py-3">@student.Email</td>
                        <td class="px-4 py-3">@student.CreatedAt.ToShortDateString()</td>
                        <td class="px-4 py-3">
                          @if (student.IsActive)
                          {
                              <span class="badge rounded-pill bg-success-subtle text-success-emphasis fs-xs fw-medium px-2 py-1">Active</span>
                          }
                          else
                          {
                              <span class="badge rounded-pill bg-secondary-subtle text-secondary-emphasis fs-xs fw-medium px-2 py-1">Inactive</span>
                          }
                        </td>
                        <td class="px-4 py-3 text-end">
                          <div class="d-flex align-items-center justify-content-end gap-2">
                            <a asp-action="EditUser" asp-route-id="@student.UserId" class="btn btn-icon-table rounded-circle p-2">
                              <span class="material-symbols-outlined fs-6">edit</span>
                            </a>
                            <form asp-action="DeleteUser" method="post" onsubmit="return confirm('Are you sure?');" style="display:inline;">
                                <input type="hidden" name="id" value="@student.UserId" />
                                <button type="submit" class="btn btn-icon-table hover-danger rounded-circle p-2">
                                  <span class="material-symbols-outlined fs-6">delete</span>
                                </button>
                            </form>
                          </div>
                        </td>
                      </tr>
                  }
              }
            </tbody>
          </table>
        </div>
        
        <nav aria-label="Table navigation" class="d-flex align-items-center justify-content-between p-4 border-top">
          <span class="fs-sm fw-normal text-secondary">Showing <span class="fw-semibold text-body-emphasis">1-4</span> of <span class="fw-semibold text-body-emphasis">1000</span></span>
          <ul class="pagination pagination-sm mb-0">
            <li class="page-item">
              <a class="page-link rounded-start-lg" href="#">Previous</a>
            </li>
            <li class="page-item active">
              <a class="page-link" href="#">1</a>
            </li>
            <li class="page-item">
              <a class="page-link" href="#">2</a>
            </li>
            <li class="page-item">
              <a class="page-link rounded-end-lg" href="#">Next</a>
            </li>
          </ul>
        </nav>
      </div>
    </main>
  </div>
</div>

@section Scripts {
    <script>
    const themeToggleBtn = document.getElementById('theme-toggle');
    const htmlElement = document.documentElement;

    themeToggleBtn?.addEventListener('click', function() {
      const currentTheme = htmlElement.getAttribute('data-bs-theme');
      if (currentTheme === 'dark') {
        htmlElement.setAttribute('data-bs-theme', 'light');
      } else {
        htmlElement.setAttribute('data-bs-theme', 'dark');
      }
    });
    </script>
}
